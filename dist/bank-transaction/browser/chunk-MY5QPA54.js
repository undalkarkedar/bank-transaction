import{a as O}from"./chunk-4NRCCPZL.js";import{a as P}from"./chunk-OGR2RECP.js";import{$ as g,F as l,J as c,K as v,O as d,Q as f,R as S,T as _,U as s,V as a,W as m,_ as b,ba as C,ca as E,d as y,pa as T,t as x,w as h,wa as w,ya as F}from"./chunk-VLOMA36Q.js";var i={fileSelection:"No file selected.",fileType:"Only CSV files are allowed.",emptyFile:"The CSV file is empty.",whiteSpace:"The CSV file is empty or contains only whitespace.",noData:"The CSV file contains only headers. It doesnt have any data.",parsingError:"Error parsing CSV file.",readingError:"Error reading file",addingTransition:"Error adding transactions. Please try again."};function N(t,n){if(t&1&&(s(0,"div",1),m(1,"div",2),a()),t&2){let e=g();l(),S("width",e.progress,"%")}}var u=class t{progress=0;static \u0275fac=function(e){return new(e||t)};static \u0275cmp=c({type:t,selectors:[["app-loader"]],inputs:{progress:"progress"},standalone:!1,decls:1,vars:1,consts:[["class","progress-bar",4,"ngIf"],[1,"progress-bar"],[1,"progress"]],template:function(e,r){e&1&&d(0,N,2,2,"div",0),e&2&&f("ngIf",r.progress>0&&r.progress<100)},dependencies:[T],styles:[".progress-bar[_ngcontent-%COMP%]{width:100%;background-color:#ddd;height:6px;border-radius:3px;margin-top:10px;overflow:hidden}.progress-bar[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]{height:100%;background-color:#007bff;width:0%;transition:width .3s ease-in-out}"]})};function L(t,n){if(t&1&&(s(0,"span",4),C(1),a()),t&2){let e=g();l(),E(e.errorMessage)}}var p=class t{transactionService$=h(O);progress=0;errorMessage=null;nav=h(w);fileUploadMsg=i;onFileSelected(n){let e=n.target.files[0];if(!e){this.errorMessage=i.fileSelection;return}if(e.type!=="text/csv"&&!e.name.endsWith(".csv")){this.errorMessage=i.fileType;return}if(e.size===0){this.errorMessage=i.emptyFile;return}let r=new FileReader;r.onload=()=>{try{let o=r.result;if(!o.trim()){this.errorMessage=i.whiteSpace;return}if(o.split(`
`).length<=1){this.errorMessage=i.noData;return}this.simulateProcessing(o)}catch{this.errorMessage=i.parsingError}},r.onerror=o=>{console.error("Error reading file:",o),this.errorMessage=i.readingError},this.errorMessage=null,r.readAsText(e)}simulateProcessing(n){return y(this,null,function*(){try{let e=yield this.transactionService$.parseCSV(n);this.progress=0;for(let r of e){this.progress=Math.round(e.indexOf(r)/e.length*100);try{yield this.transactionService$.addTransaction(r)}catch(o){console.error("Error adding transaction:",o),this.errorMessage="Error adding transactions. Please try again.";return}}this.errorMessage="",this.nav.navigate(["/transactions"])}catch{}})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=c({type:t,selectors:[["app-file-upload"]],decls:6,vars:2,consts:[[3,"progress"],[1,"file-upload-container"],["type","file","id","fileInput",3,"change"],["for","fileInput",1,"file-upload-label","btn","btn-primary"],[1,"text-danger","text-center","text-small"]],template:function(e,r){e&1&&(m(0,"app-loader",0),s(1,"div",1)(2,"input",2),b("change",function(M){return r.onFileSelected(M)}),a(),s(3,"label",3),C(4,"Choose File"),a()(),d(5,L,2,1,"span",4)),e&2&&(f("progress",r.progress),l(5),_(r.errorMessage?5:-1))},dependencies:[P,u],styles:[".file-upload-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px}.file-upload-container[_ngcontent-%COMP%]   .upload-icon[_ngcontent-%COMP%]{font-size:48px;color:#007bff}.file-upload-container[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{display:none}.file-upload-container[_ngcontent-%COMP%]   .file-label[_ngcontent-%COMP%]{padding:10px 20px;background-color:#007bff;color:#fff;border-radius:5px;cursor:pointer;font-weight:700;margin-top:10px;display:inline-block}"]})};var V=[{path:"",component:p}],U=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=v({type:t});static \u0275inj=x({imports:[p,F.forChild(V)]})};export{U as FileUploadModule};
